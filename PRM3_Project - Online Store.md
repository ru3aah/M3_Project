# Техническое задание: Интернет-магазин на Django/DRF

## 1. Введение и цель

Вы — разработчик на первой работе. Нужно трансформировать готовый статический
HTML/CSS дизайн в полноценное интернет-магазин приложение на Django. Проект
должен содержать:

- Веб-интерфейс (Django, шаблоны, сессии)
- REST API для внешних клиентов (DRF, JWT)
- (Опционально) GraphQL для аналитики как дополнительное улучшение
- Инфраструктуру: PostgreSQL, Docker
- Качество кода: типизация, линтеры, тесты, документация

Цель: показать понимание Django, DRF, работы с базой, архитектурных практик,
качества кода и деплоя.

---

## 2. Общие принципы

- **Веб-интерфейс** (пользователи через браузер) использует **session-based**
  аутентификацию (стандарт Django).
- **Внешние API** используют **JWT** для авторизации.
- GraphQL (если реализуется) доступен через **один эндпоинт** `/graphql/`.
- Структура проекта примерная — допускаются вариации, но должна быть логичная
  модульность.
- **Инфраструктура:** обязательное использование PostgreSQL, всё поднимается
  через Docker Compose.
- Альтернативные менеджеры зависимостей (`poetry`, `pip-tools/uv`)
  приветствуются как бонус.

---

## 3. Функциональные блоки

### 3.1. Каталог товаров и поиск (`/` и `/products/`)

**Функциональность:**

- Список товаров с пагинацией
- Фильтрация по категории, диапазону цен
- Поиск по названию и описанию
- Сортировка (по цене, популярности, новизне)

**Темы:** CBV, шаблоны, ORM, оптимизация запросов

### 3.2. Страница товара (`/product/<slug>/`)

- Детальная информация (название, описание, цена, изображения, рейтинг)
- Отзывы с рейтингами (1–5), возможность оставить отзыв (только после покупки —
  проверка)
- Кнопка "Добавить в корзину", выбор количества

**Темы:** CBV, формы, ORM, валидация

### 3.3. Корзина (`/cart/`)

- Просмотр содержимого корзины
- Добавление, удаление, изменение количества
- Подсчёт итоговой стоимости, учёт остатка
- Хранение в сессии
- Проверка наличия товара

**Темы:** Django Sessions, Message Framework, бизнес-логика

### 3.4. Оформление заказа (`/checkout/`)

- Форма для данных доставки/контакта
- Выбор способа оплаты (мок/эмуляция)
- Создание заказа
- Email-уведомления пользователю и администратору
- Обработка ошибок и валидация

**Темы:** Формы, email, транзакции

### 3.5. Личный кабинет (`/account/`)

- Регистрация, вход/выход (session auth)
- История заказов (с фильтрацией)
- Редактирование профиля
- Смена пароля
- (Опционально) управление адресами доставки

**Темы:** Аутентификация, ORM, формы, доступ

### 3.6. Админ-панель (`/admin/`)

- Управление товарами, категориями, заказами, отзывами, пользователями
- Аналитика: агрегаты, аннотации (выручка, топ-продукты, количество заказов)
- Поиск, фильтры, кастомные action’ы
- Права доступа

**Темы:** Админка, агрегаты, кастомизация

### 3.7. REST API (`/api/`)

Ресурсы и действия (пример):

| Ресурс       | Действие          | URL-шаблон                    | HTTP метод(ы)            | Описание                               | Авторизация    |
|--------------|-------------------|-------------------------------|--------------------------|----------------------------------------|----------------|
| Товары       | Список            | `/api/products/`              | GET                      | Пагинация, фильтрация, поиск           | Необязательно  |
| Товары       | Деталь            | `/api/products/<id>/`         | GET                      | Информация о товаре                    | Необязательно  |
| Заказы       | Создание          | `/api/orders/`                | POST                     | Создание заказа (на основе корзины)    | JWT            |
| Заказы       | Список своих      | `/api/orders/`                | GET                      | Список заказов текущего пользователя   | JWT            |
| Заказы       | Деталь            | `/api/orders/<id>/`           | GET                      | Детальная информация (только свой)     | JWT            |
| Заказы       | Обновление/отмена | `/api/orders/<id>/`           | PATCH/PUT/DELETE         | Изменение статуса/отмена (по правилам) | JWT            |
| Пользователи | Регистрация       | `/api/users/register/`        | POST                     | Создать аккаунт                        | Нет            |
| Пользователи | Вход (JWT)        | `/api/users/login/`           | POST                     | Получить access/refresh токены         | Нет            |
| Корзина      | Управление        | `/api/cart/`                  | GET, POST, PATCH, DELETE | Содержимое корзины                     | JWT или сессия |
| Отзывы       | Добавить/просмотр | `/api/products/<id>/reviews/` | GET, POST                | Список и отправка отзыва               | JWT            |

- JWT: access + refresh, обновление.
- Права: пользователь видит/меняет только свои данные.

**Темы:** DRF, сериализация, ViewSets/routers, пагинация, permissions

### 3.8. Документация API

- Swagger/OpenAPI для REST API (например, `/api/docs/`)
- Примеры запросов, схемы, авторизация

**Темы:** Автоматическая документация (drf-spectacular, drf-yasg и т.п.)

### 3.9. (Бонусно) GraphQL

- Один эндпоинт `/graphql/`
- Аналитические запросы:
    - Заказы: выручка, количество, средний чек, тренды
    - Продукты: популярные, остатки
    - Пользователи: активность, повторные покупки

**Темы:** Graphene/Django, резолверы, авторизация в GraphQL

> Примечание: GraphQL — бонус. Можно заменить на другие улучшения (например,
> расширенные тесты, CI/CD и т.п.).

---

## 4. Структура данных (База данных)

### Category

- `id` (PK)
- `name` (CharField)
- `slug` (SlugField, unique)
- `parent` (ForeignKey self, nullable) — для вложенности
- `created_at`, `updated_at`

### Product

- `id` (PK)
- `name` (CharField)
- `slug` (SlugField, unique)
- `description` (TextField)
- `price` (DecimalField)
- `category` (ForeignKey to Category)
- `image` (ImageField / мультимедиа)
- `is_active` (BooleanField)
- `stock` (IntegerField)
- `created_at`, `updated_at`

### Order

- `id` (PK)
- `user` (ForeignKey to User)
- `status` (CharField: pending, paid, shipped, delivered, cancelled)
- `total_price` (DecimalField)
- `shipping_address` (TextField / отдельная модель)
- `created_at`, `updated_at`

### OrderItem

- `id` (PK)
- `order` (ForeignKey to Order)
- `product` (ForeignKey to Product)
- `quantity` (IntegerField)
- `price` (DecimalField) — snapshot

### Review

- `id` (PK)
- `product` (ForeignKey to Product)
- `user` (ForeignKey to User)
- `rating` (IntegerField 1–5)
- `comment` (TextField)
- `created_at`

*Дополнительно:* Address, Payment и др. по необходимости.

---

## 5. Примерная архитектура проекта

/myshop/

├── config/ # settings, urls, asgi/wsgi

├── products/ # модели, views, serializers, forms, admin

├── orders/ # заказы и корзина

├── users/ # регистрация, профили, auth

├── reviews/ # отзывы (или внутри products)

├── payments/ # способы оплаты, webhooks

├── graphql/ # схема и резолверы (если используется)

├── templates/ # Django-шаблоны

├── static/ # статика

├── tests/ # тесты

├── docker-compose.yml # инфраструктура

├── Dockerfile # контейнер приложения

├── manage.py

└── README.md


> Структура примерная; приоритет — разделение ответственности, читабельность,
> расширяемость.

---

## 6. Качество кода и инфраструктура

1. **Типизация и докстринги**
    - Аннотации типов в функциях/методах.
    - Докстринги для публичных API/важных модулей.

2. **Линтеры и статическая проверка**
    - `flake8` или аналог.
    - `mypy` для типизации.

3. **Тестирование**
    - `pytest-django`.
    - Основные сценарии: каталог, корзина, заказ, регистрация/вход, REST API,
      бизнес-правила.
    - Проверка ограничений (например, нельзя заказать больше, чем в наличии).

4. **Инфраструктура**
    - PostgreSQL.
    - Docker Compose для запуска (приложение и БД и т.д.).
    - Все зависимости задокументированы (`requirements.txt`
      или `pyproject.toml`).
    - (Бонус) использование `poetry` / `uv` альтернатив.

5. **Git workflow**
    - Осмысленные мелкие коммиты.
    - Ветки: `feature/...`, `develop/...`, стабильный `main`.

6. **Документация**
    - README: описание, установка, запуск, JWT, API-примеры, тесты, линтеры,
      структура.

---

## 7. API-документация и взаимодействие

- Swagger/OpenAPI для REST API.
- Примеры запросов с JWT, объяснение схемы авторизации.
- Формат access/refresh токенов, обновление.
- (Если есть) описание типов и примеры в GraphQL.

---

## 8. Оценивание (грейдинг)

**Максимум — 100 баллов.** Бонусные улучшения не поднимают итог выше 100.

| Критерий                                                       | Баллы |
|----------------------------------------------------------------|-------|
| Каталог и поиск товаров                                        | 10    |
| Детальная страница товара и отзывы                             | 10    |
| Корзина и её обработка                                         | 10    |
| Оформление заказа и email                                      | 10    |
| Личный кабинет и история заказов                               | 10    |
| Админка и аналитика                                            | 10    |
| REST API и документация                                        | 10    |
| Качество кода и инструменты (типизация, линтеры, тесты)        | 10    |
| Инфраструктура (PostgreSQL, Docker, зависимости, git workflow) | 10    |
| README и проектная гигиена (чек-лист, коммиты, структура)      | 5     |
| Бонусы                                                         | 5     |

**Итого:** 100

**Рекомендованные улучшения (не увеличивают выше 100):**

- GraphQL аналитика
- Расширенное покрытие тестами (>=80%)
- CI/CD (проверка тестов и линтеров, сборка, деплои)
- Использование `poetry` или другого менеджера

---

## 9. Требования к сдаче

1. Репозиторий на GitHub с кодом.
2. README.md:
    - Описание
    - Установка и запуск (через Docker)
    - JWT и API-примеры
    - Запуск тестов и линтеров
    - Структура проекта
3. (Опционально) ссылка на деплой / screencast.
4. ФИО и группа + ссылка преподавателю.
5. Чек-лист реализации (отмеченное что сделано).
6. История коммитов / веток.

---

## 10. Чек-лист перед сдачей

- [ ] Проект запускается через Docker Compose на чистой копии.
- [ ] PostgreSQL используется.
- [ ] Каталог: фильтры, поиск, пагинация.
- [ ] Страница товара: детали, отзывы, добавление в корзину.
- [ ] Корзина: управление, расчёт, проверка остатков.
- [ ] Оформление заказа: создание, email, валидация.
- [ ] Личный кабинет: регистрация, вход, история, редактирование.
- [ ] REST API: JWT, документация, права.
- [ ] Админка: аналитика, фильтры, управление.
- [ ] Swagger/OpenAPI работает.
- [ ] Типизация и докстринги.
- [ ] Линтеры (flake8/mypy) без критичных ошибок.
- [ ] Базовые тесты проходят.
- [ ] README полон и понятен.
- [ ] Коммиты осмысленные, ветки используются.
- [ ] Чек-лист приложен.

---

## 11. Роадмап и таймлайн (рекомендовано)

**Рекомендуемый срок:** 3 недели

### Неделя 1

1. Инициализация: Docker, PostgreSQL, шаблоны, статика.
2. Модели: Category, Product, Order, OrderItem, Review.
3. Каталог: список, фильтры, поиск, пагинация.

### Неделя 2

4. Страница товара: отзывы, корзина.
5. Корзина: сессии, управление.
6. Оформление заказа: форма, email.
7. Личный кабинет: регистрация, история, редактирование.

### Неделя 3

8. Админка: кастомизация, статистика.
9. REST API: ViewSets, JWT, документация.
10. Качество: линтеры, типизация, тесты, README.
11. (Бонус) GraphQL / CI / расширенные тесты.
12. Финальная проверка.

---